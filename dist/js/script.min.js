"use strict";var _requests=require("./requests.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var r,n,a,i,o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(o)return n=!(r=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return r=e.done,e},e:function(e){n=!0,a=e},f:function(){try{r||null==o.return||o.return()}finally{if(n)throw a}}};if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),i=0,{s:t=function(){},n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}var MovieApp=_createClass(function e(){var D=this;_classCallCheck(this,e),_defineProperty(this,"initApp",function(){D.connectDOM(),D.setupListeners()}),_defineProperty(this,"connectDOM",function(){for(var e=0,t=Array.from(document.querySelectorAll("[data-bind-js]"));e<t.length;e++){var r=t[e];D.elements[r.classList[0].replace("-","_")]=r}}),_defineProperty(this,"setupListeners",function(){D.elements.search_btn.addEventListener("click",D.searchForMovies),D.elements.search_input.addEventListener("keydown",D.searchForMovies),D.elements.movie_box.addEventListener("click",D.addToFavorites),D.elements.fav_btn.addEventListener("click",D.renderFavorites)}),_defineProperty(this,"searchForMovies",function(e){"click"!==event.type&&"Enter"!==event.key||(e=D.elements.search_input.value,(D.elements.movie_box.innerHTML="",_requests.getMovieDataByName)(e).then(function(e){var t,r=_createForOfIteratorHelper(e.Search);try{for(r.s();!(t=r.n()).done;){var n=t.value;D.createMovieCard(n)}}catch(e){r.e(e)}finally{r.f()}}),D.elements.search_input.value="")}),_defineProperty(this,"addToFavorites",function(e){var t;if(void 0!==e.target.dataset.id)t=e.target.dataset.id;else try{t=e.target.closest(".movie-card").dataset.id}catch(e){t=null}if(e.target.classList.contains("fa-regular"))e.target.classList.remove("fa-regular"),e.target.classList.add("fa-solid"),e.target.style.display="block",D.favorites.push(t);else if(e.target.classList.contains("fa-solid")){e.target.classList.remove("fa-solid"),e.target.classList.add("fa-regular"),e.target.style.display="";for(var r=0;r<D.favorites.length;r++)D.favorites[r]===t&&D.favorites.splice(r,1)}localStorage.setItem("favorites",JSON.stringify(D.favorites))}),_defineProperty(this,"renderFavorites",function(e){D.elements.movie_box.innerHTML="",D.favorites.forEach(function(e){(0,_requests.getMovieInfo)(e).then(function(e){D.createMovieCard(e)})})}),_defineProperty(this,"createMovieCard",function(e){var t=e.Title,r=e.Poster,n="fa-regular fa-heart",a=(D.favorites.includes(e.imdbID)&&(n="fa-solid fa-heart"),60<t.length&&(t=e.Title.substring(0,60)+"..."),"N/A"==r&&(r="https://via.placeholder.com/210x295"),D.createDOMElem("div","movie-card")),t=D.createDOMElem("h3",null,t),i=D.createDOMElem("p",null,e.Year),n=D.createDOMElem("i",n),o=D.createDOMElem("div","shadow");n.classList.contains("fa-solid")&&(n.style.display="block"),o.append(t,i),a.append(n,o),a.dataset.id=e.imdbID,a.style.backgroundImage="url(".concat(r,")"),D.elements.title_box.innerHTML="",D.elements.movie_box.append(a),a.addEventListener("click",D.openMovieSecondView)}),_defineProperty(this,"createDOMElem",function(e,t,r,n){e=document.createElement(e);return e.classList=t,r&&(e.textContent=r),n&&(e.src=n),e}),_defineProperty(this,"openMovieSecondView",function(e){var t;e.target.dataset.id?t=e.target.dataset.id:e.target.dataset.id||e.target.classList.contains("fa-heart")||(t=e.target.closest(".movie-card").dataset.id),(0,_requests.getMovieInfo)(t).then(function(e){var t=e.Poster,r="fa-regular fa-heart";D.favorites.includes(e.imdbID)&&(r="fa-solid fa-heart");try{g=e.Ratings[0].Value}catch(e){g="no rating"}try{_=e.Ratings[1].Value}catch(e){_="no rating"}try{O=e.Ratings[2].Value}catch(e){O="no rating"}"N/A"==t&&(t="https://via.placeholder.com/350x550");var n=D.createDOMElem("div","movie-details-box"),t=D.createDOMElem("img","poster",null,t),a=D.createDOMElem("div","details"),i=D.createDOMElem("h2",null,e.Title),o=D.createDOMElem("p",null,"Year: ".concat(e.Year)),l=D.createDOMElem("p",null,"Actors: ".concat(e.Actors)),s=D.createDOMElem("p",null,"Genres: ".concat(e.Genre)),c=D.createDOMElem("p",null,"Director: ".concat(e.Director)),d=D.createDOMElem("p",null,"Runtime: ".concat(e.Runtime)),u=D.createDOMElem("p",null,"Country: ".concat(e.Country)),f=D.createDOMElem("p","info-text","".concat(e.Plot)),m=D.createDOMElem("div","rating-details"),p=D.createDOMElem("button","details-btn","close"),r=D.createDOMElem("i",r),v=D.createDOMElem("div","rating-box"),y=D.createDOMElem("img",null,null,"/dist/img/imdb2.png"),g=D.createDOMElem("p","rating",g),b=D.createDOMElem("div","rating-box"),h=D.createDOMElem("img",null,null,"/dist/img/RTlogo.png"),_=D.createDOMElem("p","rating",_),M=D.createDOMElem("div","rating-box"),E=D.createDOMElem("img",null,null,"/dist/img/metacriticLogo.png"),O=D.createDOMElem("p","rating",O);v.append(y,g),b.append(h,_),M.append(E,O),m.append(v,b,M),a.append(i,o,l,s,c,d,u,f,m,p,r),n.append(t,a),n.style.display="flex",r.dataset.id=e.imdbID,D.elements.movie_box.append(n),D.elements.overlay.style.display="block",document.body.style.overflow="hidden",document.querySelector(".details-btn").addEventListener("click",function(){D.elements.movie_box.removeChild(D.elements.movie_box.lastChild),D.elements.overlay.style.display="none",document.body.style.overflow=""}),document.querySelector(".fa-heart").addEventListener("click",D.addToFavorites)})}),this.elements={},this.favorites=JSON.parse(localStorage.getItem("favorites"))||[],this.initApp()});document.addEventListener("DOMContentLoaded",new MovieApp);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJfcmVxdWVzdHMiLCJyZXF1aXJlIiwiX3R5cGVvZiIsIm9iaiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsIm8iLCJhbGxvd0FycmF5TGlrZSIsIm5vcm1hbENvbXBsZXRpb24iLCJkaWRFcnIiLCJlcnIiLCJpIiwiaXQiLCJzIiwiY2FsbCIsIm4iLCJzdGVwIiwibmV4dCIsImRvbmUiLCJlIiwiX2UyIiwiZiIsIkFycmF5IiwiaXNBcnJheSIsIl91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheSIsImxlbmd0aCIsIkYiLCJ2YWx1ZSIsIl9lIiwiVHlwZUVycm9yIiwibWluTGVuIiwiX2FycmF5TGlrZVRvQXJyYXkiLCJPYmplY3QiLCJ0b1N0cmluZyIsInNsaWNlIiwibmFtZSIsImZyb20iLCJ0ZXN0IiwiYXJyIiwibGVuIiwiYXJyMiIsIl9kZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiZGVmaW5lUHJvcGVydHkiLCJfdG9Qcm9wZXJ0eUtleSIsImtleSIsIl9jcmVhdGVDbGFzcyIsIkNvbnN0cnVjdG9yIiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJfZGVmaW5lUHJvcGVydHkiLCJhcmciLCJfdG9QcmltaXRpdmUiLCJTdHJpbmciLCJpbnB1dCIsImhpbnQiLCJwcmltIiwidG9QcmltaXRpdmUiLCJ1bmRlZmluZWQiLCJOdW1iZXIiLCJyZXMiLCJNb3ZpZUFwcCIsIl90aGlzIiwidGhpcyIsImNvbm5lY3RET00iLCJzZXR1cExpc3RlbmVycyIsIl9pIiwiX2VsZW1lbnRzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZWxlbWVudHMiLCJjbGFzc0xpc3QiLCJyZXBsYWNlIiwiZWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZWFyY2hGb3JNb3ZpZXMiLCJzZWFyY2hfYnRuIiwiYWRkVG9GYXZvcml0ZXMiLCJzZWFyY2hfaW5wdXQiLCJyZW5kZXJGYXZvcml0ZXMiLCJldmVudCIsIm1vdmllX2JveCIsImlubmVySFRNTCIsImdldE1vdmllRGF0YUJ5TmFtZSIsIl9zdGVwIiwiZGF0YSIsIlNlYXJjaCIsIl9pdGVyYXRvciIsIml0ZW0iLCJjcmVhdGVNb3ZpZUNhcmQiLCJpZCIsImRhdGFzZXQiLCJjbG9zZXN0IiwiY29udGFpbnMiLCJhZGQiLCJzdHlsZSIsImRpc3BsYXkiLCJmYXZvcml0ZXMiLCJwdXNoIiwicmVtb3ZlIiwibG9jYWxTdG9yYWdlIiwic3RyaW5naWZ5IiwiZm9yRWFjaCIsImdldE1vdmllSW5mbyIsInRoZW4iLCJpbmZvIiwidGl0bGUiLCJUaXRsZSIsInBvc3RlciIsIlBvc3RlciIsImljb25DbGFzcyIsImluY2x1ZGVzIiwiaW1kYklEIiwic3Vic3RyaW5nIiwiY3JlYXRlRE9NRWxlbSIsImRpdkNhcmQiLCJoZWFkaW5nIiwiWWVhciIsInBhcmFncmFwaCIsImljb24iLCJzaGFkb3ciLCJhcHBlbmQiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJ0YWciLCJjcmVhdGVFbGVtZW50IiwidGFnTmFtZSIsInRleHRDb250ZW50Iiwic3JjIiwiY2xhc3NOYW1lIiwibW92aWVJZCIsInJ0UmF0aW5nIiwibWV0YVJhdGluZyIsImltZGJSYXRpbmciLCJSYXRpbmdzIiwicG9zdGVySW1hZ2UiLCJWYWx1ZSIsImRldGFpbHNEaXYiLCJ5ZWFyIiwiYWN0b3JzIiwiY291bnRyeSIsImluZm9UZXh0IiwicmF0aW5nQm94RGl2T25lIiwicmF0aW5nUGFyYWdyYXBoT25lIiwiaW1nIiwicmF0aW5nQm94RGl2VHdvIiwiZGV0YWlsc1RleHQiLCJyYXRpbmdQYXJhZ3JhcGhUd28iLCJyYXRpbmdCb3hEaXZUaHJlZSIsInJhdGluZ0ltZ1RocmVlIiwiY29uY2F0IiwiQWN0b3JzIiwiZ2VucmVzIiwicmF0aW5nUGFyYWdyYXBoVGhyZWUiLCJHZW5yZSIsInJhdGluZ0RldGFpbHNEaXYiLCJEaXJlY3RvciIsIlJ1bnRpbWUiLCJDb3VudHJ5IiwiUGxvdCIsImNsb3NlQnRuIiwib3ZlcmxheSIsImJvZHkiLCJ2aWV3Q2xvc2VCdG4iLCJyYXRpbmdJbWdPbmUiLCJyZW1vdmVDaGlsZCIsInF1ZXJ5U2VsZWN0b3IiLCJwYXJzZSIsImdldEl0ZW0iLCJpbml0QXBwIiwicmF0aW5nSW1nVHdvIiwiZGlyZWN0b3IiLCJydW50aW1lIiwib3ZlcmZsb3ciLCJsYXN0Q2hpbGQiLCJKU09OIl0sIm1hcHBpbmdzIjoiYUFBQSxJQUFBQSxVQUFBQyxRQUFBLGVBQUEsRUFBaUUsU0FBQUMsUUFBQUMsR0FBQSxPQUFBRCxRQUFBLFlBQUEsT0FBQUUsUUFBQSxVQUFBLE9BQUFBLE9BQUFDLFNBQUEsU0FBQUYsR0FBQSxPQUFBLE9BQUFBLENBQUEsRUFBQSxTQUFBQSxHQUFBLE9BQUFBLEdBQUEsWUFBQSxPQUFBQyxRQUFBRCxFQUFBRyxjQUFBRixRQUFBRCxJQUFBQyxPQUFBRyxVQUFBLFNBQUEsT0FBQUosQ0FBQSxHQUFBQSxDQUFBLENBQUEsQ0FBQSxTQUFBSywyQkFBQUMsRUFBQUMsR0FBQSxJQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBLGFBQUEsT0FBQVgsUUFBQUssRUFBQUwsT0FBQUMsV0FBQUksRUFBQSxjQUFBLEdBQUFNLEVBQUEsT0FBQUgsRUFBQSxFQUFBRCxFQUFBLENBQUEsR0FBQSxDQUFBSyxFQUFBLFdBQUFELEVBQUFBLEVBQUFFLEtBQUFSLENBQUEsQ0FBQSxFQUFBUyxFQUFBLFdBQUEsSUFBQUMsRUFBQUosRUFBQUssS0FBQSxFQUFBLE9BQUFULEVBQUFRLEVBQUFFLEtBQUFGLENBQUEsRUFBQUcsRUFBQSxTQUFBQyxHQUFBWCxFQUFBLENBQUEsRUFBQUMsRUFBQVUsQ0FBQSxFQUFBQyxFQUFBLFdBQUEsSUFBQWIsR0FBQSxNQUFBSSxF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VSxRQUN0QzVCLFNBQVM2RixLQUFLbEUsTUFBTTZFLFNBQVcsU0FFVnhHLFNBQVNpRyxjQUFjLGNBQWMsRUFDN0MzRixpQkFBaUIsUUFBUyxXQUN0Q1osRUFBS1EsU0FBU1csVUFBVW1GLFlBQVl0RyxFQUFLUSxTQUFTVyxVQUFVNEYsU0FBUyxFQUNyRS9HLEVBQUtRLFNBQVMwRixRQUFRakUsTUFBTUMsUUFBVSxPQUN0QzVCLFNBQVM2RixLQUFLbEUsTUFBTTZFLFNBQVcsRUFDaEMsQ0FBQyxFQUNEeEcsU0FBU2lHLGNBQWMsV0FBVyxFQUFFM0YsaUJBQWlCLFFBQVNaLEVBQUtlLGNBQWMsQ0FDbEYsQ0FBQyxDQUNGLENBQUMsRUFoUCtEZCxLQUFBTyxTQUFBLEdBQUFQLEtBQUFrQyxVQUFBNkUsS0FBQVIsTUFBQWxFLGFBQUFtRSxRQUFBLFdBQUEsQ0FBQSxHQUFBLEdBQUF4RyxLQUFBeUcsUUFBQSxDQUFBLENBQUEsRUFtUGpFcEcsU0FBU00saUJBQWlCLG1CQUFvQixJQUFJYixRQUFVIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRNb3ZpZURhdGFCeU5hbWUsIGdldE1vdmllSW5mbyB9IGZyb20gJy4vcmVxdWVzdHMuanMnO1xuXG5jbGFzcyBNb3ZpZUFwcCB7XG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHRoaXMuZWxlbWVudHMgPSB7fTtcblx0XHR0aGlzLmZhdm9yaXRlcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Zhdm9yaXRlcycpKSB8fCBbXTtcblx0XHR0aGlzLmluaXRBcHAoKTtcblx0fVxuXG5cdGluaXRBcHAgPSAoKSA9PiB7XG5cdFx0dGhpcy5jb25uZWN0RE9NKCk7XG5cdFx0dGhpcy5zZXR1cExpc3RlbmVycygpO1xuXHR9O1xuXG5cdGNvbm5lY3RET00gPSAoKSA9PiB7XG5cdFx0Y29uc3QgZWxlbWVudHMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWJpbmQtanNdJykpO1xuXG5cdFx0Zm9yIChjb25zdCBlbGVtZW50IG9mIGVsZW1lbnRzKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnRzW2VsZW1lbnQuY2xhc3NMaXN0WzBdLnJlcGxhY2UoJy0nLCAnXycpXSA9IGVsZW1lbnQ7XG5cdFx0fVxuXHR9O1xuXG5cdHNldHVwTGlzdGVuZXJzID0gKCkgPT4ge1xuXHRcdHRoaXMuZWxlbWVudHMuc2VhcmNoX2J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuc2VhcmNoRm9yTW92aWVzKTtcblx0XHR0aGlzLmVsZW1lbnRzLnNlYXJjaF9pbnB1dC5hZGRFdmVudExpc3RlbmVyKFxuXHRcdFx0J2tleWRvd24nLFxuXHRcdFx0dGhpcy5zZWFyY2hGb3JNb3ZpZXNcblx0XHQpXG5cdFx0dGhpcy5lbGVtZW50cy5tb3ZpZV9ib3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmFkZFRvRmF2b3JpdGVzKTtcblx0XHR0aGlzLmVsZW1lbnRzLmZhdl9idG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnJlbmRlckZhdm9yaXRlcyk7XG5cblx0fTtcblxuXHRzZWFyY2hGb3JNb3ZpZXMgPSAoaW5wdXQpID0+IHtcblx0XHRpZiAoZXZlbnQudHlwZSA9PT0gJ2NsaWNrJyB8fCBldmVudC5rZXkgPT09ICdFbnRlcicpIHtcblx0XHRcdGlucHV0ID0gdGhpcy5lbGVtZW50cy5zZWFyY2hfaW5wdXQudmFsdWU7XG5cdFx0XHR0aGlzLmVsZW1lbnRzLm1vdmllX2JveC5pbm5lckhUTUwgPSAnJztcblx0XHRcdGdldE1vdmllRGF0YUJ5TmFtZShpbnB1dCkudGhlbigoZGF0YSkgPT4ge1xuXHRcdFx0XHRmb3IgKGNvbnN0IGl0ZW0gb2YgZGF0YS5TZWFyY2gpIHtcblx0XHRcdFx0XHR0aGlzLmNyZWF0ZU1vdmllQ2FyZChpdGVtKVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdHRoaXMuZWxlbWVudHMuc2VhcmNoX2lucHV0LnZhbHVlID0gJyc7XG5cdFx0fVxuXHR9O1xuXG5cdGFkZFRvRmF2b3JpdGVzID0gKGUpID0+IHtcblx0XHRsZXQgaWRcblxuXHRcdGlmIChlLnRhcmdldC5kYXRhc2V0LmlkICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGlkID0gZS50YXJnZXQuZGF0YXNldC5pZFxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRpZCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5tb3ZpZS1jYXJkJykuZGF0YXNldC5pZFxuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRpZCA9IG51bGxcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmYS1yZWd1bGFyJykpIHtcblx0XHRcdGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2ZhLXJlZ3VsYXInKTtcblx0XHRcdGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2ZhLXNvbGlkJyk7XG5cdFx0XHRlLnRhcmdldC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHRcdHRoaXMuZmF2b3JpdGVzLnB1c2goaWQpO1xuXHRcdH0gZWxzZSBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmYS1zb2xpZCcpKSB7XG5cdFx0XHRlLnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdmYS1zb2xpZCcpO1xuXHRcdFx0ZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnZmEtcmVndWxhcicpO1xuXHRcdFx0ZS50YXJnZXQuc3R5bGUuZGlzcGxheSA9ICcnO1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZhdm9yaXRlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZiAodGhpcy5mYXZvcml0ZXNbaV0gPT09IGlkKSB7XG5cdFx0XHRcdFx0dGhpcy5mYXZvcml0ZXMuc3BsaWNlKGksIDEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmYXZvcml0ZXMnLCBKU09OLnN0cmluZ2lmeSh0aGlzLmZhdm9yaXRlcykpO1xuXHR9O1xuXG5cdHJlbmRlckZhdm9yaXRlcyA9IChpZCkgPT4ge1xuXHRcdHRoaXMuZWxlbWVudHMubW92aWVfYm94LmlubmVySFRNTCA9ICcnO1xuXHRcdGlkID0gdGhpcy5mYXZvcml0ZXM7XG5cblx0XHRpZC5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHRnZXRNb3ZpZUluZm8oaXRlbSkudGhlbigoaW5mbykgPT4ge1xuXHRcdFx0XHR0aGlzLmNyZWF0ZU1vdmllQ2FyZChpbmZvKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9O1xuXG5cdGNyZWF0ZU1vdmllQ2FyZCA9IChpdGVtKSA9PiB7XG5cdFx0bGV0IHRpdGxlID0gaXRlbS5UaXRsZTtcblx0XHRsZXQgcG9zdGVyID0gaXRlbS5Qb3N0ZXI7XG5cdFx0bGV0IGljb25DbGFzcyA9ICdmYS1yZWd1bGFyIGZhLWhlYXJ0JztcblxuXHRcdGlmICh0aGlzLmZhdm9yaXRlcy5pbmNsdWRlcyhpdGVtLmltZGJJRCkpIGljb25DbGFzcyA9ICdmYS1zb2xpZCBmYS1oZWFydCc7XG5cdFx0aWYgKHRpdGxlLmxlbmd0aCA+IDYwKSB0aXRsZSA9IGl0ZW0uVGl0bGUuc3Vic3RyaW5nKDAsIDYwKSArICcuLi4nO1xuXHRcdGlmIChwb3N0ZXIgPT0gJ04vQScpIHBvc3RlciA9ICdodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vMjEweDI5NSc7XG5cblx0XHRjb25zdCBkaXZDYXJkID0gdGhpcy5jcmVhdGVET01FbGVtKCdkaXYnLCAnbW92aWUtY2FyZCcpO1xuXHRcdGNvbnN0IGhlYWRpbmcgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2gzJywgbnVsbCwgdGl0bGUpO1xuXHRcdGNvbnN0IHBhcmFncmFwaCA9IHRoaXMuY3JlYXRlRE9NRWxlbSgncCcsIG51bGwsIGl0ZW0uWWVhcik7XG5cdFx0Y29uc3QgaWNvbiA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnaScsIGljb25DbGFzcyk7XG5cdFx0Y29uc3Qgc2hhZG93ID0gdGhpcy5jcmVhdGVET01FbGVtKCdkaXYnLCAnc2hhZG93Jyk7XG5cblx0XHRpZiAoaWNvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2ZhLXNvbGlkJykpIGljb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cblx0XHRzaGFkb3cuYXBwZW5kKGhlYWRpbmcsIHBhcmFncmFwaCk7XG5cdFx0ZGl2Q2FyZC5hcHBlbmQoaWNvbiwgc2hhZG93KTtcblx0XHRkaXZDYXJkLmRhdGFzZXQuaWQgPSBpdGVtLmltZGJJRDtcblx0XHRkaXZDYXJkLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHtwb3N0ZXJ9KWA7XG5cblx0XHR0aGlzLmVsZW1lbnRzLnRpdGxlX2JveC5pbm5lckhUTUwgPSAnJztcblx0XHR0aGlzLmVsZW1lbnRzLm1vdmllX2JveC5hcHBlbmQoZGl2Q2FyZCk7XG5cblx0XHRkaXZDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuTW92aWVTZWNvbmRWaWV3KTtcblx0fTtcblxuXHRjcmVhdGVET01FbGVtID0gKHRhZ05hbWUsIGNsYXNzTmFtZSwgdGV4dENvbnRlbnQsIHNyYykgPT4ge1xuXHRcdGNvbnN0IHRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSk7XG5cdFx0dGFnLmNsYXNzTGlzdCA9IGNsYXNzTmFtZTtcblxuXHRcdGlmICh0ZXh0Q29udGVudCkge1xuXHRcdFx0dGFnLnRleHRDb250ZW50ID0gdGV4dENvbnRlbnQ7XG5cdFx0fVxuXHRcdGlmIChzcmMpIHtcblx0XHRcdHRhZy5zcmMgPSBzcmM7XG5cdFx0fVxuXHRcdHJldHVybiB0YWc7XG5cdH07XG5cblx0b3Blbk1vdmllU2Vjb25kVmlldyA9IChldmVudCkgPT4ge1xuXHRcdGxldCBtb3ZpZUlkO1xuXG5cdFx0aWYgKGV2ZW50LnRhcmdldC5kYXRhc2V0LmlkKSB7XG5cdFx0XHRtb3ZpZUlkID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQuaWQ7XG5cdFx0fSBlbHNlIGlmIChcblx0XHRcdCFldmVudC50YXJnZXQuZGF0YXNldC5pZCAmJlxuXHRcdFx0IWV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2ZhLWhlYXJ0Jylcblx0XHQpIHtcblx0XHRcdG1vdmllSWQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLm1vdmllLWNhcmQnKS5kYXRhc2V0LmlkO1xuXHRcdH1cblxuXHRcdGdldE1vdmllSW5mbyhtb3ZpZUlkKS50aGVuKChpbmZvKSA9PiB7XG5cdFx0XHRsZXQgaW1kYlJhdGluZztcblx0XHRcdGxldCBydFJhdGluZztcblx0XHRcdGxldCBtZXRhUmF0aW5nO1xuXHRcdFx0bGV0IHBvc3RlckltYWdlID0gaW5mby5Qb3N0ZXI7XG5cdFx0XHRsZXQgaWNvbkNsYXNzID0gJ2ZhLXJlZ3VsYXIgZmEtaGVhcnQnO1xuXG5cdFx0XHRpZiAodGhpcy5mYXZvcml0ZXMuaW5jbHVkZXMoaW5mby5pbWRiSUQpKSBpY29uQ2xhc3MgPSAnZmEtc29saWQgZmEtaGVhcnQnO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRpbWRiUmF0aW5nID0gaW5mby5SYXRpbmdzWzBdLlZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRpbWRiUmF0aW5nID0gJ25vIHJhdGluZyc7XG5cdFx0XHR9XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRydFJhdGluZyA9IGluZm8uUmF0aW5nc1sxXS5WYWx1ZTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0cnRSYXRpbmcgPSAnbm8gcmF0aW5nJztcblx0XHRcdH1cblx0XHRcdHRyeSB7XG5cdFx0XHRcdG1ldGFSYXRpbmcgPSBpbmZvLlJhdGluZ3NbMl0uVmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdG1ldGFSYXRpbmcgPSAnbm8gcmF0aW5nJztcblx0XHRcdH1cblxuXHRcdFx0aWYgKHBvc3RlckltYWdlID09ICdOL0EnKVxuXHRcdFx0XHRwb3N0ZXJJbWFnZSA9ICdodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vMzUweDU1MCc7XG5cblx0XHRcdGNvbnN0IGRldGFpbHNEaXYgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2RpdicsICdtb3ZpZS1kZXRhaWxzLWJveCcpO1xuXHRcdFx0Y29uc3QgaW1nID0gdGhpcy5jcmVhdGVET01FbGVtKCdpbWcnLCAncG9zdGVyJywgbnVsbCwgcG9zdGVySW1hZ2UpO1xuXHRcdFx0Y29uc3QgZGV0YWlsc1RleHQgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2RpdicsICdkZXRhaWxzJyk7XG5cdFx0XHRjb25zdCB0aXRsZSA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnaDInLCBudWxsLCBpbmZvLlRpdGxlKTtcblx0XHRcdGNvbnN0IHllYXIgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ3AnLCBudWxsLCBgWWVhcjogJHtpbmZvLlllYXJ9YCk7XG5cdFx0XHRjb25zdCBhY3RvcnMgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ3AnLCBudWxsLCBgQWN0b3JzOiAke2luZm8uQWN0b3JzfWApO1xuXHRcdFx0Y29uc3QgZ2VucmVzID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgbnVsbCwgYEdlbnJlczogJHtpbmZvLkdlbnJlfWApO1xuXHRcdFx0Y29uc3QgZGlyZWN0b3IgPSB0aGlzLmNyZWF0ZURPTUVsZW0oXG5cdFx0XHRcdCdwJyxcblx0XHRcdFx0bnVsbCxcblx0XHRcdFx0YERpcmVjdG9yOiAke2luZm8uRGlyZWN0b3J9YFxuXHRcdFx0KTtcblx0XHRcdGNvbnN0IHJ1bnRpbWUgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ3AnLCBudWxsLCBgUnVudGltZTogJHtpbmZvLlJ1bnRpbWV9YCk7XG5cdFx0XHRjb25zdCBjb3VudHJ5ID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgbnVsbCwgYENvdW50cnk6ICR7aW5mby5Db3VudHJ5fWApO1xuXHRcdFx0Y29uc3QgaW5mb1RleHQgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ3AnLCAnaW5mby10ZXh0JywgYCR7aW5mby5QbG90fWApO1xuXHRcdFx0Y29uc3QgcmF0aW5nRGV0YWlsc0RpdiA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnZGl2JywgJ3JhdGluZy1kZXRhaWxzJyk7XG5cdFx0XHRjb25zdCBjbG9zZUJ0biA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnYnV0dG9uJywgJ2RldGFpbHMtYnRuJywgJ2Nsb3NlJyk7XG5cdFx0XHRjb25zdCBpY29uID0gdGhpcy5jcmVhdGVET01FbGVtKCdpJywgaWNvbkNsYXNzKTtcblxuXHRcdFx0Y29uc3QgcmF0aW5nQm94RGl2T25lID0gdGhpcy5jcmVhdGVET01FbGVtKCdkaXYnLCAncmF0aW5nLWJveCcpO1xuXHRcdFx0Y29uc3QgcmF0aW5nSW1nT25lID0gdGhpcy5jcmVhdGVET01FbGVtKCdpbWcnLCBudWxsLCBudWxsLCAnL2Rpc3QvaW1nL2ltZGIyLnBuZycpO1xuXHRcdFx0Y29uc3QgcmF0aW5nUGFyYWdyYXBoT25lID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgJ3JhdGluZycsIGltZGJSYXRpbmcpO1xuXG5cdFx0XHRjb25zdCByYXRpbmdCb3hEaXZUd28gPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2RpdicsICdyYXRpbmctYm94Jyk7XG5cdFx0XHRjb25zdCByYXRpbmdJbWdUd28gPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2ltZycsIG51bGwsIG51bGwsICcvZGlzdC9pbWcvUlRsb2dvLnBuZycpO1xuXHRcdFx0Y29uc3QgcmF0aW5nUGFyYWdyYXBoVHdvID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgJ3JhdGluZycsIHJ0UmF0aW5nKTtcblxuXHRcdFx0Y29uc3QgcmF0aW5nQm94RGl2VGhyZWUgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2RpdicsICdyYXRpbmctYm94Jyk7XG5cdFx0XHRjb25zdCByYXRpbmdJbWdUaHJlZSA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnaW1nJywgbnVsbCwgbnVsbCwgJy9kaXN0L2ltZy9tZXRhY3JpdGljTG9nby5wbmcnKTtcblx0XHRcdGNvbnN0IHJhdGluZ1BhcmFncmFwaFRocmVlID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgJ3JhdGluZycsIG1ldGFSYXRpbmcpO1xuXHRcdFx0XG5cblx0XHRcdHJhdGluZ0JveERpdk9uZS5hcHBlbmQocmF0aW5nSW1nT25lLCByYXRpbmdQYXJhZ3JhcGhPbmUpO1xuXHRcdFx0cmF0aW5nQm94RGl2VHdvLmFwcGVuZChyYXRpbmdJbWdUd28sIHJhdGluZ1BhcmFncmFwaFR3byk7XG5cdFx0XHRyYXRpbmdCb3hEaXZUaHJlZS5hcHBlbmQocmF0aW5nSW1nVGhyZWUsIHJhdGluZ1BhcmFncmFwaFRocmVlKTtcblxuXHRcdFx0cmF0aW5nRGV0YWlsc0Rpdi5hcHBlbmQoXG5cdFx0XHRcdHJhdGluZ0JveERpdk9uZSxcblx0XHRcdFx0cmF0aW5nQm94RGl2VHdvLFxuXHRcdFx0XHRyYXRpbmdCb3hEaXZUaHJlZVxuXHRcdFx0KTtcblxuXHRcdFx0ZGV0YWlsc1RleHQuYXBwZW5kKFxuXHRcdFx0XHR0aXRsZSxcblx0XHRcdFx0eWVhcixcblx0XHRcdFx0YWN0b3JzLFxuXHRcdFx0XHRnZW5yZXMsXG5cdFx0XHRcdGRpcmVjdG9yLFxuXHRcdFx0XHRydW50aW1lLFxuXHRcdFx0XHRjb3VudHJ5LFxuXHRcdFx0XHRpbmZvVGV4dCxcblx0XHRcdFx0cmF0aW5nRGV0YWlsc0Rpdixcblx0XHRcdFx0Y2xvc2VCdG4sXG5cdFx0XHRcdGljb25cblx0XHRcdCk7XG5cdFx0XHRkZXRhaWxzRGl2LmFwcGVuZChpbWcsIGRldGFpbHNUZXh0KTtcblxuXHRcdFx0ZGV0YWlsc0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuXHRcdFx0aWNvbi5kYXRhc2V0LmlkID0gaW5mby5pbWRiSURcblx0XHRcdHRoaXMuZWxlbWVudHMubW92aWVfYm94LmFwcGVuZChkZXRhaWxzRGl2KTtcblx0XHRcdHRoaXMuZWxlbWVudHMub3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHRcdGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcblxuXHRcdFx0Y29uc3Qgdmlld0Nsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRldGFpbHMtYnRuJyk7XG5cdFx0XHR2aWV3Q2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZWxlbWVudHMubW92aWVfYm94LnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudHMubW92aWVfYm94Lmxhc3RDaGlsZCk7XG5cdFx0XHRcdHRoaXMuZWxlbWVudHMub3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJyc7XG5cdFx0XHR9KTtcblx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYS1oZWFydCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5hZGRUb0Zhdm9yaXRlcylcblx0XHR9KVxuXHR9O1xufVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgbmV3IE1vdmllQXBwKCkpO1xuIl19
