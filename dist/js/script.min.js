"use strict";var _requests=require("./requests.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var r,n,a,i,o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(o)return n=!(r=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return r=e.done,e},e:function(e){n=!0,a=e},f:function(){try{r||null==o.return||o.return()}finally{if(n)throw a}}};if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),i=0,{s:t=function(){},n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}var MovieApp=_createClass(function e(){var D=this;_classCallCheck(this,e),_defineProperty(this,"initApp",function(){D.connectDOM(),D.setupListeners()}),_defineProperty(this,"connectDOM",function(){for(var e=0,t=Array.from(document.querySelectorAll("[data-bind-js]"));e<t.length;e++){var r=t[e];D.elements[r.classList[0].replace("-","_")]=r}}),_defineProperty(this,"setupListeners",function(){D.elements.search_btn.addEventListener("click",D.searchForMovies),D.elements.search_input.addEventListener("keydown",D.searchForMovies),D.elements.movie_box.addEventListener("click",D.addToFavorites),D.elements.fav_btn.addEventListener("click",D.renderFavorites)}),_defineProperty(this,"searchForMovies",function(e){"click"!==event.type&&"Enter"!==event.key||(e=D.elements.search_input.value,(D.elements.movie_box.innerHTML="",_requests.getMovieDataByName)(e).then(function(e){return D.renderCards(e)}),D.elements.search_input.value="")}),_defineProperty(this,"renderCards",function(e){var t,r=_createForOfIteratorHelper(e.Search);try{for(r.s();!(t=r.n()).done;){var n=t.value;D.createMovieCard(n)}}catch(e){r.e(e)}finally{r.f()}}),_defineProperty(this,"addToFavorites",function(e){var t;if(void 0!==e.target.dataset.id)t=e.target.dataset.id;else try{t=e.target.closest(".movie-card").dataset.id}catch(e){t=null}if(e.target.classList.contains("fa-regular"))e.target.classList.remove("fa-regular"),e.target.classList.add("fa-solid"),e.target.style.display="block",D.favorites.push(t);else if(e.target.classList.contains("fa-solid")){e.target.classList.remove("fa-solid"),e.target.classList.add("fa-regular"),e.target.style.display="";for(var r=0;r<D.favorites.length;r++)D.favorites[r]===t&&D.favorites.splice(r,1)}localStorage.setItem("favorites",JSON.stringify(D.favorites))}),_defineProperty(this,"renderFavorites",function(e){D.elements.movie_box.innerHTML="",D.favorites.forEach(function(e){(0,_requests.getMovieInfo)(e).then(function(e){D.createMovieCard(e)})})}),_defineProperty(this,"createMovieCard",function(e){var t=e.Title,r=e.Poster,n="fa-regular fa-heart",a=(D.favorites.includes(e.imdbID)&&(n="fa-solid fa-heart"),60<t.length&&(t=e.Title.substring(0,60)+"..."),"N/A"==r&&(r="https://via.placeholder.com/210x295"),D.createDOMElem("div","movie-card")),t=D.createDOMElem("h3",null,t),i=D.createDOMElem("p",null,e.Year),n=D.createDOMElem("i",n),o=D.createDOMElem("div","shadow");n.classList.contains("fa-solid")&&(n.style.display="block"),o.append(t,i),a.append(n,o),a.dataset.id=e.imdbID,a.style.backgroundImage="url(".concat(r,")"),D.elements.title_box.innerHTML="",D.elements.movie_box.append(a),a.addEventListener("click",D.openMovieSecondView)}),_defineProperty(this,"createDOMElem",function(e,t,r,n){e=document.createElement(e);return e.classList=t,r&&(e.textContent=r),n&&(e.src=n),e}),_defineProperty(this,"openMovieSecondView",function(e){var t;e.target.dataset.id?t=e.target.dataset.id:e.target.dataset.id||e.target.classList.contains("fa-heart")||(t=e.target.closest(".movie-card").dataset.id),(0,_requests.getMovieInfo)(t).then(function(e){var t=e.Poster,r="fa-regular fa-heart";D.favorites.includes(e.imdbID)&&(r="fa-solid fa-heart");try{g=e.Ratings[0].Value}catch(e){g="no rating"}try{_=e.Ratings[1].Value}catch(e){_="no rating"}try{O=e.Ratings[2].Value}catch(e){O="no rating"}"N/A"==t&&(t="https://via.placeholder.com/350x550");var n=D.createDOMElem("div","movie-details-box"),t=D.createDOMElem("img","poster",null,t),a=D.createDOMElem("div","details"),i=D.createDOMElem("h2",null,e.Title),o=D.createDOMElem("p",null,"Year: ".concat(e.Year)),l=D.createDOMElem("p",null,"Actors: ".concat(e.Actors)),s=D.createDOMElem("p",null,"Genres: ".concat(e.Genre)),c=D.createDOMElem("p",null,"Director: ".concat(e.Director)),d=D.createDOMElem("p",null,"Runtime: ".concat(e.Runtime)),u=D.createDOMElem("p",null,"Country: ".concat(e.Country)),f=D.createDOMElem("p","info-text","".concat(e.Plot)),m=D.createDOMElem("div","rating-details"),p=D.createDOMElem("button","details-btn","close"),r=D.createDOMElem("i",r),v=D.createDOMElem("div","rating-box"),y=D.createDOMElem("img",null,null,"/dist/img/imdb2.png"),g=D.createDOMElem("p","rating",g),h=D.createDOMElem("div","rating-box"),b=D.createDOMElem("img",null,null,"/dist/img/RTlogo.png"),_=D.createDOMElem("p","rating",_),M=D.createDOMElem("div","rating-box"),E=D.createDOMElem("img",null,null,"/dist/img/metacriticLogo.png"),O=D.createDOMElem("p","rating",O);v.append(y,g),h.append(b,_),M.append(E,O),m.append(v,h,M),a.append(i,o,l,s,c,d,u,f,m,p,r),n.append(t,a),n.style.display="flex",r.dataset.id=e.imdbID,D.elements.movie_box.append(n),D.elements.overlay.style.display="block",document.body.style.overflow="hidden",document.querySelector(".details-btn").addEventListener("click",function(){D.elements.movie_box.removeChild(D.elements.movie_box.lastChild),D.elements.overlay.style.display="none",document.body.style.overflow=""}),document.querySelector(".fa-heart").addEventListener("click",D.addToFavorites)})}),this.elements={},this.favorites=JSON.parse(localStorage.getItem("favorites"))||[],this.initApp()});document.addEventListener("DOMContentLoaded",new MovieApp);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJfcmVxdWVzdHMiLCJyZXF1aXJlIiwiX3R5cGVvZiIsIm9iaiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsIm8iLCJhbGxvd0FycmF5TGlrZSIsIm5vcm1hbENvbXBsZXRpb24iLCJkaWRFcnIiLCJlcnIiLCJpIiwiaXQiLCJzIiwiY2FsbCIsIm4iLCJzdGVwIiwibmV4dCIsImRvbmUiLCJlIiwiX2UyIiwiZiIsIkFycmF5IiwiaXNBcnJheSIsIl91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheSIsImxlbmd0aCIsIkYiLCJ2YWx1ZSIsIl9lIiwiVHlwZUVycm9yIiwibWluTGVuIiwiX2FycmF5TGlrZVRvQXJyYXkiLCJPYmplY3QiLCJ0b1N0cmluZyIsInNsaWNlIiwibmFtZSIsImZyb20iLCJ0ZXN0IiwiYXJyIiwibGVuIiwiYXJyMiIsIl9kZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiZGVmaW5lUHJvcGVydHkiLCJfdG9Qcm9wZXJ0eUtleSIsImtleSIsIl9jcmVhdGVDbGFzcyIsIkNvbnN0cnVjdG9yIiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJfZGVmaW5lUHJvcGVydHkiLCJhcmciLCJfdG9QcmltaXRpdmUiLCJTdHJpbmciLCJpbnB1dCIsImhpbnQiLCJwcmltIiwidG9QcmltaXRpdmUiLCJ1bmRlZmluZWQiLCJOdW1iZXIiLCJyZXMiLCJNb3ZpZUFwcCIsIl90aGlzIiwidGhpcyIsImNvbm5lY3RET00iLCJzZXR1cExpc3RlbmVycyIsIl9pIiwiX2VsZW1lbnRzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZWxlbWVudHMiLCJjbGFzc0xpc3QiLCJyZXBsYWNlIiwiZWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZWFyY2hGb3JNb3ZpZXMiLCJzZWFyY2hfYnRuIiwiYWRkVG9GYXZvcml0ZXMiLCJzZWFyY2hfaW5wdXQiLCJyZW5kZXJGYXZvcml0ZXMiLCJldmVudCIsIm1vdmllX2JveCIsImlubmVySFRNTCIsImdldE1vdmllRGF0YUJ5TmFtZSIsInRoZW4iLCJkYXRhIiwicmVuZGVyQ2FyZHMiLCJfc3RlcCIsIl9pdGVyYXRvciIsIlNlYXJjaCIsIml0ZW0iLCJjcmVhdGVNb3ZpZUNhcmQiLCJpZCIsImRhdGFzZXQiLCJjbG9zZXN0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJzdHlsZSIsImRpc3BsYXkiLCJwdXNoIiwiZmF2b3JpdGVzIiwibG9jYWxTdG9yYWdlIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldE1vdmllSW5mbyIsImluZm8iLCJ0aXRsZSIsIlRpdGxlIiwicG9zdGVyIiwiUG9zdGVyIiwiaWNvbkNsYXNzIiwiaW1kYklEIiwic3Vic3RyaW5nIiwiY3JlYXRlRE9NRWxlbSIsImRpdkNhcmQiLCJZZWFyIiwiaGVhZGluZyIsInBhcmFncmFwaCIsImljb24iLCJzaGFkb3ciLCJhcHBlbmQiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJvcGVuTW92aWVTZWNvbmRWaWV3IiwiY2xhc3NOYW1lIiwidGV4dENvbnRlbnQiLCJzcmMiLCJ0YWciLCJjcmVhdGVFbGVtZW50IiwidGFnTmFtZSIsIm1vdmllSWQiLCJpbWRiUmF0aW5nIiwicnRSYXRpbmciLCJwb3N0ZXJJbWFnZSIsImluY2x1ZGVzIiwibWV0YVJhdGluZyIsIlJhdGluZ3MiLCJWYWx1ZSIsImRldGFpbHNUZXh0IiwiZGlyZWN0b3IiLCJydW50aW1lIiwiZGV0YWlsc0RpdiIsImltZyIsInJhdGluZ1BhcmFncmFwaE9uZSIsInJhdGluZ0JveERpdlR3byIsInJhdGluZ0ltZ1R3byIsInllYXIiLCJyYXRpbmdQYXJhZ3JhcGhUd28iLCJhY3RvcnMiLCJyYXRpbmdCb3hEaXZUaHJlZSIsIkFjdG9ycyIsImdlbnJlcyIsInJhdGluZ0ltZ1RocmVlIiwiY29uY2F0IiwiR2VucmUiLCJyYXRpbmdQYXJhZ3JhcGhUaHJlZSIsImNvdW50cnkiLCJDb3VudHJ5IiwiUGxvdCIsImNsb3NlQnRuIiwib3ZlcmxheSIsInJhdGluZ0JveERpdk9uZSIsInF1ZXJ5U2VsZWN0b3IiLCJ2aWV3Q2xvc2VCdG4iLCJyZW1vdmVDaGlsZCIsImxhc3RDaGlsZCIsIm92ZXJmbG93IiwicmF0aW5nSW1nT25lIiwicmF0aW5nRGV0YWlsc0RpdiIsImluZm9UZXh0IiwiYm9keSIsInBhcnNlIiwiZ2V0SXRlbSIsImluaXRBcHAiXSwibWFwcGluZ3MiOiJhQUFBLElBQUFBLFVBQUFDLFFBQUEsZUFBQSxFQUFpRSxTQUFBQyxRQUFBQyxHQUFBLE9BQUFELFFBQUEsWUFBQSxPQUFBRSxRQUFBLFVBQUEsT0FBQUEsT0FBQUMsU0FBQSxTQUFBRixHQUFBLE9BQUEsT0FBQUEsQ0FBQSxFQUFBLFNBQUFBLEdBQUEsT0FBQUEsR0FBQSxZQUFBLE9BQUFDLFFBQUFELEVBQUFHLGNBQUFGLFFBQUFELElBQUFDLE9BQUFHLFVBQUEsU0FBQSxPQUFBSixDQUFBLEdBQUFBLENBQUEsQ0FBQSxDQUFBLFNBQUFLLDJCQUFBQyxFQUFBQyxHQUFBLElBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUEsYUFBQSxPQUFBWCxRQUFBSyxFQUFBTCxPQUFBQyxXQUFBSSxFQUFBLGNBQUEsR0FBQU0sRUFBQSxPQUFBSCxFQUFBLEVBQUFELEVBQUEsQ0FBQSxHQUFBLENBQUFLLEVBQUEsV0FBQUQsRUFBQUEsRUFBQUUsS0FBQVIsQ0FBQSxDQUFBLEVBQUFTLEVBQUEsV0FBQSxJQUFBQyxFQUFBSixFQUFBSyxLQUFBLEVBQUEsT0FBQVQsRUFBQVEsRUFBQUUsS0FBQUYsQ0FBQSxFQUFBRyxFQUFBLFNBQUFDLEdBQUFYLEVBQUEsQ0FBQSxFQUFBQyxFQUFBVSxDQUFBLEVBQUFDLEVBQUEsV0FBQSxJQUFBYixHQUFBLE1BQUFJLEVBQUEsUUFBQUEsRUFBQSxPQUFBLENBQUEsQ0FBQSxRQUFBLEdBQUFILEVBQUEsTUFBQUMsQ0FBQSxDQUFBLENBQUEsRUFBQSxHQUFBWSxNQUFBQyxRQUFBakIsQ0FBQSxJQUFBTSxFQUFBWSw0QkFBQWxCLENBQUEsSUFBQUMsR0FBQUQsR0FBQSxVQUFBLE9BQUFBLEVBQUFtQixPQUFBLE9BQUFiLElBQUFOLEVBQUFNLEdBQUFELEVBQUEsRUFBQSxDQUFBRSxFQUFBYSxFQUFBLGFBQUFYLEVBQUEsV0FBQSxPQUFBSixHQUFBTCxFQUFBbUIsT0FBQSxDQUFBUCxLQUFBLENBQUEsQ0FBQSxFQUFBLENBQUFBLEtBQUEsQ0FBQSxFQUFBUyxNQUFBckIsRUFBQUssQ0FBQSxHQUFBLENBQUEsRUFBQVEsRUFBQSxTQUFBUyxHQUFBLE1BQUFBLENBQUEsRUFBQVAsRUFBQUssQ0FBQSxFQUFBLE1BQUEsSUFBQUcsVUFBQSx1SUFBQSxDQUFBLENBQUEsU0FBQUwsNEJBQUFsQixFQUFBd0IsR0FBQSxJQUFBZixFQUFBLEdBQUFULEVBQUEsTUFBQSxVQUFBLE9BQUFBLEVBQUF5QixrQkFBQXpCLEVBQUF3QixDQUFBLEVBQUEsU0FBQWYsRUFBQSxZQUFBQSxFQUFBaUIsT0FBQTVCLFVBQUE2QixTQUFBbkIsS0FBQVIsQ0FBQSxFQUFBNEIsTUFBQSxFQUFBLENBQUEsQ0FBQSxJQUFBNUIsRUFBQUgsWUFBQUcsRUFBQUgsWUFBQWdDLEtBQUFwQixJQUFBLFFBQUFBLEVBQUFPLE1BQUFjLEtBQUE5QixDQUFBLEVBQUEsY0FBQVMsR0FBQSwyQ0FBQXNCLEtBQUF0QixDQUFBLEVBQUFnQixrQkFBQXpCLEVBQUF3QixDQUFBLEVBQUEsS0FBQSxDQUFBLENBQUEsU0FBQUMsa0JBQUFPLEVBQUFDLElBQUEsTUFBQUEsR0FBQUEsRUFBQUQsRUFBQWIsVUFBQWMsRUFBQUQsRUFBQWIsUUFBQSxJQUFBLElBQUFkLEVBQUEsRUFBQTZCLEVBQUEsSUFBQWxCLE1BQUFpQixDQUFBLEVBQUE1QixFQUFBNEIsRUFBQTVCLENBQUEsR0FBQTZCLEVBQUE3QixHQUFBMkIsRUFBQTNCLEdBQUEsT0FBQTZCLENBQUEsQ0FBQSxTQUFBQyxrQkFBQUMsRUFBQUMsR0FBQSxJQUFBLElBQUFoQyxFQUFBLEVBQUFBLEVBQUFnQyxFQUFBbEIsT0FBQWQsQ0FBQSxHQUFBLENBQUEsSUFBQWlDLEVBQUFELEVBQUFoQyxHQUFBaUMsRUFBQUMsV0FBQUQsRUFBQUMsWUFBQSxDQUFBLEVBQUFELEVBQUFFLGFBQUEsQ0FBQSxFQUFBLFVBQUFGLElBQUFBLEVBQUFHLFNBQUEsQ0FBQSxHQUFBZixPQUFBZ0IsZUFBQU4sRUFBQU8sZUFBQUwsRUFBQU0sR0FBQSxFQUFBTixDQUFBLENBQUEsQ0FBQSxDQUFBLFNBQUFPLGFBQUFDLEVBQUFDLEVBQUFDLEdBQUEsT0FBQUQsR0FBQVosa0JBQUFXLEVBQUFoRCxVQUFBaUQsQ0FBQSxFQUFBQyxHQUFBYixrQkFBQVcsRUFBQUUsQ0FBQSxFQUFBdEIsT0FBQWdCLGVBQUFJLEVBQUEsWUFBQSxDQUFBTCxTQUFBLENBQUEsQ0FBQSxDQUFBLEVBQUFLLENBQUEsQ0FBQSxTQUFBRyxnQkFBQUMsRUFBQUosR0FBQSxHQUFBLEVBQUFJLGFBQUFKLEdBQUEsTUFBQSxJQUFBdkIsVUFBQSxtQ0FBQSxDQUFBLENBQUEsU0FBQTRCLGdCQUFBekQsRUFBQWtELEVBQUF2QixHQUFBLE9BQUF1QixFQUFBRCxlQUFBQyxDQUFBLEtBQUFsRCxFQUFBZ0MsT0FBQWdCLGVBQUFoRCxFQUFBa0QsRUFBQSxDQUFBdkIsTUFBQUEsRUFBQWtCLFdBQUEsQ0FBQSxFQUFBQyxhQUFBLENBQUEsRUFBQUMsU0FBQSxDQUFBLENBQUEsQ0FBQSxFQUFBL0MsRUFBQWtELEdBQUF2QixFQUFBM0IsQ0FBQSxDQUFBLFNBQUFpRCxlQUFBUyxHQUFBUixFQUFBUyxhQUFBRCxFQUFBLFFBQUEsRUFBQSxNQUFBLFdBQUEzRCxRQUFBbUQsQ0FBQSxFQUFBQSxFQUFBVSxPQUFBVixDQUFBLENBQUEsQ0FBQSxTQUFBUyxhQUFBRSxFQUFBQyxHQUFBLEdBQUEsV0FBQS9ELFFBQUE4RCxDQUFBLEdBQUEsT0FBQUEsRUFBQSxPQUFBQSxFQUFBLElBQUFFLEVBQUFGLEVBQUE1RCxPQUFBK0QsYUFBQSxHQUFBQyxLQUFBQSxJQUFBRixFQUFBLE9BQUEsV0FBQUQsRUFBQUYsT0FBQU0sUUFBQUwsQ0FBQSxFQUFBTSxFQUFBSixFQUFBakQsS0FBQStDLEVBQUFDLEdBQUEsU0FBQSxFQUFBLEdBQUEsV0FBQS9ELFFBQUFvRSxDQUFBLEVBQUEsT0FBQUEsRUFBQSxNQUFBLElBQUF0QyxVQUFBLDhDQUFBLENBQUEsQ0FBQSxJQUFqRXVDLFNBQUFqQixhQUFpRSxTQUFBaUIsSUFBQSxJQUFBQyxFQUFBQyxLQUFBZixnQkFBQWUsS0FBQUYsQ0FBQSxFQUFBWCxnQkFBQWEsS0FBQSxVQUFBLFdBQUFELEVBQUFFLFdBQUEsRUFBQUYsRUFBQUcsZUFBQSxDQUFBLENBQUEsRUFBQWYsZ0JBQUFhLEtBQUEsYUFHbEQsV0FjYixJQWRhLElBY2JHLEVBQUEsRUFBQUMsRUFkYXBELE1BQUFjLEtBQUF1QyxTQUFBQyxpQkFBQSxnQkFBQSxDQUFBLEVBT0lILEVBQUFDLEVBQUFqRCxPQUFBZ0QsQ0FBQSxHQUFBLENBQWpCLElBQUtGLEVBQVVHLEVBQUFELEdBUWRKLEVBUERRLFNBQUtMLEVBQWNNLFVBQUUsR0FBQUMsUUFBQSxJQUFBLEdBQUEsR0FBQUMsQ0FDdEIsQ0FRQSxDQVJDLEVBQUF2QixnQkFBQWEsS0FBQSxpQkFLQSxXQU1BRCxFQU5LUSxTQUFNRyxXQUFPQyxpQkFBQSxRQUFBWixFQUFBYSxlQUFBLEVBT2xCYixFQU5DUSxTQUFLQSxhQUFpQkMsaUJBT3RCLFVBTERULEVBQUFhLGVBQUEsRUFRQWIsRUFMQVEsU0FBS0EsVUFBU00saUJBQVdGLFFBQWlCWixFQUFTZSxjQUFLRixFQU14RGIsRUFMQVEsU0FBS0EsUUFBU1EsaUJBQWFKLFFBQzFCWixFQUFBaUIsZUFDS0osQ0FLUCxDQUFDLEVBQUF6QixnQkFBQWEsS0FBQSxrQkFBQSxTQUFBVCxHQUdjLFVBQWQwQixNQUFJQSxNQUFtQyxVQUFiQSxNQUFJQSxNQUM3QjFCLEVBQUtRLEVBQUdRLFNBQUtBLGFBQVNRLE9BQ3RCaEIsRUFBQVEsU0FBS0EsVUFBU1csVUFBVUMsR0FDeEJDLFVBQUFBLG9CQUFBQSxDQUFBQSxFQUFBQSxLQUFBQSxTQUFBQSxHQUFrQixPQUFDN0IsRUFBTzhCLFlBQUtDLENBQUNBLENBQUksQ0FBQSxFQUNwQ3ZCLEVBRG9DUSxTQUFLUSxhQUFLUSxNQUFpQixHQUdqRSxDQUFDLEVBQUFwQyxnQkFBQWEsS0FBQSxjQUFBLFNBQUFzQixHQUFBLElBQUFFLEVBQUFDLEVBQUExRiwyQkFBQXVGLEVBQUFJLE1BQUEsRUFBQSxJQUFBLElBQUFELEVBQUFsRixFQUFBLEVBQUEsRUFBQWlGLEVBQUFDLEVBQUFoRixFQUFBLEdBQUFHLE1BQUEsQ0FBQSxJQUFBK0UsRUFBQUgsRUFBQW5FLE1BSUMwQyxFQUZzQjZCLGdCQUFBRCxDQUFBLENBR3ZCLENBQUMsQ0FBQSxNQUFBdkYsR0FBQXFGLEVBQUE1RSxFQUFBVCxDQUFBLENBQUEsQ0FBQSxRQUFBcUYsRUFBQTFFLEVBQUEsQ0FBQSxDQUNGLENBQUMsRUFBQW9DLGdCQUFBYSxLQUFBLGlCQUhlLFNBQUFuRCxHQU1mLElBQUlnRixFQUVKLEdBTkNsQyxLQUFBQSxJQUFBOUMsRUFBQXVCLE9BQUEwRCxRQUFBRCxHQU9BQSxFQVBBaEYsRUFBQXVCLE9BQUEwRCxRQUFBRCxRQVNBLElBVEFBLEVBQUFoRixFQUFBdUIsT0FBQTJELFFBQUEsYUFBQSxFQUFBRCxRQUFBRCxFQWFBLENBWkQsTUFBQWhGLEdBQUFnRixFQUFBLElBWUMsQ0FHRCxHQVJDaEYsRUFBQXVCLE9BQU1vQyxVQUFBd0IsU0FBQSxZQUFBLEVBU05uRixFQUFFdUIsT0FSRW9DLFVBQUF5QixPQUFBLFlBQUEsRUFTSnBGLEVBQUV1QixPQVJDb0MsVUFBWXVCLElBQUFBLFVBQVEsRUFTdkJsRixFQUFFdUIsT0FSQThELE1BQVVDLFFBQUEsUUFTWnBDLEVBUkM4QixVQUFTTyxLQUFBUCxDQUFBLE9BQ1YsR0FBQWhGLEVBQUF1QixPQUFBb0MsVUFBQXdCLFNBQUEsVUFBQSxFQUFBLENBU0FuRixFQVJEdUIsT0FBQW9DLFVBQUF5QixPQUFBLFVBQUEsRUFTQ3BGLEVBUER1QixPQUFNQSxVQUFPb0MsSUFBUyxZQUFVLEVBUS9CM0QsRUFBRXVCLE9BUEFBLE1BQU9vQyxRQUFVeUIsR0FRbkIsSUFQRTdELElBQUFBLEVBQU9vQyxFQUFBQSxFQUFBQSxFQUFhNkIsVUFBQ2xGLE9BQVdkLENBQUEsR0FDaEMrQixFQUFBQSxVQUFhK0QsS0FBT04sR0FRcEI5QixFQVBGc0MsVUFBS0EsT0FBZVIsRUFBRyxDQUFBLENBVXhCLENBQ0FTLGFBUFVKLFFBQU1DLFlBQVlJLEtBQUFDLFVBQUF6QyxFQUFBc0MsU0FBQSxDQUFBLENBUTdCLENBQUMsRUFBQWxELGdCQUFBYSxLQUFBLGtCQUxRcUMsU0FBQUEsR0FRUnRDLEVBQUtRLFNBUEhXLFVBQUFDLFVBQUEsR0FDRHBCLEVBQUFzQyxVQUVEQyxRQUFBQSxTQUFBQSxJQUNBLEVBQUFHLFVBQUFBLGNBQUFkLENBQUEsRUFBQU4sS0FBQSxTQUFBcUIsR0FBQTNDLEVBQUE2QixnQkFBQWMsQ0FBQSxDQVNDLENBTkQsQ0FPQSxDQUFDLENBQ0YsQ0FBQyxFQUFBdkQsZ0JBQUFhLEtBQUEsa0JBSE80QixTQUFBQSxHQU1QLElBTENlLEVBQUVoQixFQUFBaUIsTUFDREMsRUFBQWxCLEVBQUFtQixPQUNGQyxFQUFBLHNCQVFJSixHQUxKNUMsRUFBSTRDLFVBQWFDLFNBQUtqQixFQUFBcUIsTUFBQSxJQUFBRCxFQUFBLHFCQUNMLEdBQWpCSixFQUFJRSxTQUFjQyxFQUFNbkIsRUFBQWlCLE1BQUFLLFVBQUEsRUFBQSxFQUFBLEVBQUEsT0FDcEJGLE9BQUpGLElBQWdCQSxFQUFBLHVDQUdOMUYsRUFBUytGLGNBQVl2QixNQUFLaUIsWUFBZ0IsR0FDaERDLEVBQVU5QyxFQUFLbUQsY0FBVyxLQUFBLEtBQUFQLENBQUEsRUFFeEJRLEVBQVVwRCxFQUFLbUQsY0FBYyxJQUFLLEtBQUV2QixFQUFBeUIsSUFBYSxFQUNqREMsRUFBT3RELEVBQUdtRCxjQUFLQSxJQUFjSCxDQUFVLEVBQ3ZDTyxFQUFTdkQsRUFBR21ELGNBQUtBLE1BQWlCLFFBQVF2QixFQUVoRDRCLEVBQU1DLFVBQVN4QixTQUFLa0IsVUFBYyxJQUFLSyxFQUFFckIsTUFBU0MsUUFBQSxTQUlsRHFCLEVBQUFBLE9BQU9DLEVBQWNILENBQUVBLEVBQ3ZCSCxFQUFBQSxPQUFRTSxFQUFXRCxDQUFFQSxFQUNyQkwsRUFBQUEsUUFBUXJCLEdBQVVILEVBQUdBLE9BQ3JCd0IsRUFBQUEsTUFBUWpCLGdCQUFNd0IsT0FBQUEsT0FBZWIsRUFBQSxHQUFBLEVBRTdCOUMsRUFDQVEsU0FBS0EsVUFBU1csVUFBaUJpQyxHQUEvQnBELEVBRUFvRCxTQUFReEMsVUFBQUEsT0FBaUJ3QyxDQUFTLEVBQ2xDQSxFQUFBeEMsaUJBQUEsUUFBQVosRUFFZTRELG1CQUFVQyxDQUYxQixDQUFDLEVBQUF6RSxnQkFBQWEsS0FBQSxnQkFNSTZELFNBQUFBLEVBQWFELEVBQUFDLEVBQUFDLEdBQ2hCQyxFQUFJRixTQUFXRyxjQUFjQyxDQUFBLEVBSzlCLE9BUkFGLEVBSUF2RCxVQUFBb0QsRUFFQ0csSUFIQUEsRUFJREYsWUFBQUEsR0FFQUMsSUFBQUMsRUFBQUQsSUFBQUEsR0FLSTdDLENBTEwsQ0FBQyxFQUFBOUIsZ0JBQUFhLEtBQUEsc0JBV2lCNUIsU0FBQUEsR0FSakIsSUFTQThGLEVBR0NqRCxFQUFJa0QsT0FBQUEsUUFBVXRDLEdBVGRxQyxFQVVJRSxFQUFRaEcsT0FBQTBELFFBQUFELEdBUlhaLEVBVUdvRCxPQUFBQSxRQUFjM0IsSUFUakJ6QixFQVVHOEIsT0FBQUEsVUFBWWYsU0FBQSxVQUFxQixJQVJyQ2tDLEVBWUlqRCxFQUFBN0MsT0FBQTJELFFBQUEsYUFBQSxFQUFBRCxRQUFBRCxLQVRMLEVBQUFZLFVBQUFBLGNBWUUwQixDQUFhLEVBQUE5QyxLQUFBLFNBQUFxQixHQVhkLElBZUMyQixFQUFXM0IsRUFBQUksT0FYUkMsRUFZUSxzQkFFWmhELEVBQUlzQyxVQUFBaUMsU0FBQTVCLEVBQUFNLE1BQUEsSUFBQUQsRUFBQSxxQkFWSixJQUNDb0IsRUFZQUksRUFBYUMsUUFBQSxHQUFXQyxLQVR6QixDQUZFLE1BWUY1SCxHQVhDc0gsRUFhR0UsV0FaSixDQUNBLElBQ0NELEVBZUtNLEVBQUFBLFFBQWMsR0FBS3hCLEtBWnpCLENBRkUsTUFlSVAsR0FkTHlCLEVBZVMsV0FkVixDQUNBLElBQ0NHLEVBZUtJLEVBQVdILFFBQUt0QixHQUFBQSxLQVp0QixDQUZFLE1BbUJJMEIsR0FsQkxMLEVBbUJZLFdBbEJiLENBcUJpQixPQUFqQkYsSUFsQkNBLEVBbUJZLHVDQWpCYixJQW9CQVEsRUFBa0I5RSxFQUFHbUQsY0FBS0EsTUFBYyxtQkFBbUIsRUFDM0Q0QixFQUFNQyxFQUFBQSxjQUFxQixNQUFLN0IsU0FBYyxLQUFLbUIsQ0FBVUYsRUFFN0RPLEVBQU1NLEVBQWtCOUIsY0FBS0EsTUFBYyxTQUFPLEVBQ2xEUCxFQUFNc0MsRUFBWS9CLGNBQVFBLEtBQUFBLEtBQWNSLEVBQU9FLEtBQU0sRUFDckRzQyxFQUFNQyxFQUFBQSxjQUFxQixJQUFLakMsS0FBQUEsU0FBQUEsT0FBaUJSLEVBQUVVLElBQVEsQ0FBQSxFQUUzRGdDLEVBQU1DLEVBQUFBLGNBQXlCbkMsSUFBQUEsS0FBQUEsV0FBQUEsT0FBcUJSLEVBQUE0QyxNQUFhLENBQUEsRUFDakVDLEVBQU1DLEVBQUFBLGNBQXNCdEMsSUFBQUEsS0FBYSxXQUFBdUMsT0FBWS9DLEVBQU1nRCxLQUFFLENBQUEsRUFDN0RmLEVBQU1nQixFQUFBQSxjQXJCTCxJQUNBLEtBd0JEWCxhQUFBQSxPQUNBSyxFQUFBQSxRQUF3QixDQUFBLEVBUXhCWCxFQUFZakIsRUFBTVAsY0FHakJrQyxJQUFBQSxLQUNBRyxZQUFBQSxPQUNBWixFQUNBQyxPQUNBZ0IsQ0FBQUEsRUFNRGYsRUFBV3BCLEVBQU9xQixjQUFLSixJQUFZLEtBQUEsWUFBQWUsT0FBQS9DLEVBQUFtRCxPQUFBLENBQUEsRUFFbkNoQixFQUFXM0MsRUFBTUMsY0FBZ0IsSUFBQSxZQUFBLEdBQUFzRCxPQUFBL0MsRUFBQW9ELElBQUEsQ0FBQSxFQUNqQ3ZDLEVBQXNCeEQsRUFBQ2lELGNBQU0sTUFBQSxnQkFBQSxFQUM3QitDLEVBQWFoRyxFQUFDbUIsY0FBaUIyRCxTQUFXLGNBQUEsT0FBQSxFQUMxQ3RCLEVBQUtoRCxFQUFTeUYsY0FBYzdELElBQUFBLENBQVUsRUFHdEM4RCxFQUFxQjVGLEVBQUFBLGNBQVM2RixNQUFjLFlBQWUsRUFDM0RDLEVBQWF4RixFQUFBQSxjQUF3QixNQUFFLEtBQUEsS0FBTSxxQkFBQSxFQUM1Q29FLEVBQWM3RCxFQUFVa0YsY0FBWSxJQUFLN0YsU0FBU1csQ0FBVW1GLEVBRTVEaEcsRUFBbUJOLEVBQUN1RyxjQUFhLE1BQUEsWUFBQSxFQUNoQ3JCLEVBQUFsRixFQUFBbUQsY0FBQSxNQUFBLEtBQUEsS0FBQSxzQkFBQSxFQUNGN0MsRUFBdUJOLEVBQUFtRCxjQUFhdkMsSUFBQUEsU0FBaUJ5RCxDQUFTLEVBRS9EaUIsRUFBQXRGLEVBQUFtRCxjQUFBLE1BQUEsWUFBQSxFQTlPSzNDLEVBQWFSLEVBQUFtRCxjQUFBLE1BQUEsS0FBQSxLQUFBLDhCQUFBLEVBQ2JiLEVBQXVCQyxFQUFBQSxjQUFxQixJQUFBLFNBQWFpQyxDQUFNLEVBZ1B0RWxFLEVBQVNNLE9BQWlCNEYsRUFBQXhCLENBQWdDLEVBekN2REMsRUFBZ0J2QixPQUFPd0IsRUFBY0UsQ0FBa0IsRUFDdkRFLEVBQWtCNUIsT0FBTytCLEVBQWdCRyxDQUFvQixFQUU3RGEsRUFBaUIvQyxPQUNoQndDLEVBQ0FqQixFQUNBSyxDQUFpQixFQUdsQlgsRUFBWWpCLE9BQ1hkLEVBQ0F1QyxFQUNBRSxFQUNBRyxFQUNBWixFQUNBQyxFQUNBZ0IsRUFDQWEsRUFDQUQsRUFDQVQsRUFDQXhDLENBQUksRUFFTHNCLEVBQVdwQixPQUFPcUIsRUFBS0osQ0FBVyxFQUVsQ0csRUFBVzNDLE1BQU1DLFFBQVUsT0FDM0JvQixFQUFLekIsUUFBUUQsR0FBS2EsRUFBS00sT0FDdkJqRCxFQUFLUSxTQUFTVyxVQUFVdUMsT0FBT29CLENBQVUsRUFDekM5RSxFQUFLUSxTQUFTeUYsUUFBUTlELE1BQU1DLFFBQVUsUUFDdEM5QixTQUFTcUcsS0FBS3hFLE1BQU1vRSxTQUFXLFNBRVZqRyxTQUFTNkYsY0FBYyxjQUFjLEVBQzdDdkYsaUJBQWlCLFFBQVMsV0FDdENaLEVBQUtRLFNBQVNXLFVBQVVrRixZQUFZckcsRUFBS1EsU0FBU1csVUFBVW1GLFNBQVMsRUFDckV0RyxFQUFLUSxTQUFTeUYsUUFBUTlELE1BQU1DLFFBQVUsT0FDdEM5QixTQUFTcUcsS0FBS3hFLE1BQU1vRSxTQUFXLEVBQ2hDLENBQUMsRUFDRGpHLFNBQVM2RixjQUFjLFdBQVcsRUFBRXZGLGlCQUFpQixRQUFTWixFQUFLZSxjQUFjLENBQ2xGLENBQUMsQ0FDRixDQUFDLEVBbFArRGQsS0FBQU8sU0FBQSxHQUFBUCxLQUFBcUMsVUFBQUUsS0FBQW9FLE1BQUFyRSxhQUFBc0UsUUFBQSxXQUFBLENBQUEsR0FBQSxHQUFBNUcsS0FBQTZHLFFBQUEsQ0FBQSxDQUFBLEVBcVBqRXhHLFNBQVNNLGlCQUFpQixtQkFBb0IsSUFBSWIsUUFBVSIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0TW92aWVEYXRhQnlOYW1lLCBnZXRNb3ZpZUluZm8gfSBmcm9tICcuL3JlcXVlc3RzLmpzJztcblxuY2xhc3MgTW92aWVBcHAge1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHR0aGlzLmVsZW1lbnRzID0ge307XG5cdFx0dGhpcy5mYXZvcml0ZXMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmYXZvcml0ZXMnKSkgfHwgW107XG5cdFx0dGhpcy5pbml0QXBwKCk7XG5cdH1cblxuXHRpbml0QXBwID0gKCkgPT4ge1xuXHRcdHRoaXMuY29ubmVjdERPTSgpO1xuXHRcdHRoaXMuc2V0dXBMaXN0ZW5lcnMoKTtcblx0fTtcblxuXHRjb25uZWN0RE9NID0gKCkgPT4ge1xuXHRcdGNvbnN0IGVsZW1lbnRzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1iaW5kLWpzXScpKTtcblxuXHRcdGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50cykge1xuXHRcdFx0dGhpcy5lbGVtZW50c1tlbGVtZW50LmNsYXNzTGlzdFswXS5yZXBsYWNlKCctJywgJ18nKV0gPSBlbGVtZW50O1xuXHRcdH1cblx0fTtcblxuXHRzZXR1cExpc3RlbmVycyA9ICgpID0+IHtcblx0XHR0aGlzLmVsZW1lbnRzLnNlYXJjaF9idG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNlYXJjaEZvck1vdmllcyk7XG5cdFx0dGhpcy5lbGVtZW50cy5zZWFyY2hfaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcblx0XHRcdCdrZXlkb3duJyxcblx0XHRcdHRoaXMuc2VhcmNoRm9yTW92aWVzXG5cdFx0KVxuXHRcdHRoaXMuZWxlbWVudHMubW92aWVfYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5hZGRUb0Zhdm9yaXRlcyk7XG5cdFx0dGhpcy5lbGVtZW50cy5mYXZfYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5yZW5kZXJGYXZvcml0ZXMpO1xuXG5cdH07XG5cblx0c2VhcmNoRm9yTW92aWVzID0gKGlucHV0KSA9PiB7XG5cdFx0aWYgKGV2ZW50LnR5cGUgPT09ICdjbGljaycgfHwgZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XG5cdFx0XHRpbnB1dCA9IHRoaXMuZWxlbWVudHMuc2VhcmNoX2lucHV0LnZhbHVlO1xuXHRcdFx0dGhpcy5lbGVtZW50cy5tb3ZpZV9ib3guaW5uZXJIVE1MID0gJyc7XG5cdFx0XHRnZXRNb3ZpZURhdGFCeU5hbWUoaW5wdXQpLnRoZW4oKGRhdGEpID0+IHRoaXMucmVuZGVyQ2FyZHMoZGF0YSkpO1xuXHRcdFx0dGhpcy5lbGVtZW50cy5zZWFyY2hfaW5wdXQudmFsdWUgPSAnJztcblx0XHR9XG5cdH07XG5cblx0cmVuZGVyQ2FyZHMgPSAoZGF0YSkgPT4ge1xuXHRcdGZvciAoY29uc3QgaXRlbSBvZiBkYXRhLlNlYXJjaCkge1xuXHRcdFx0dGhpcy5jcmVhdGVNb3ZpZUNhcmQoaXRlbSk7XG5cdFx0fVxuXHR9O1xuXG5cdGFkZFRvRmF2b3JpdGVzID0gKGUpID0+IHtcblx0XHRsZXQgaWRcblxuXHRcdGlmIChlLnRhcmdldC5kYXRhc2V0LmlkICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGlkID0gZS50YXJnZXQuZGF0YXNldC5pZFxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRpZCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5tb3ZpZS1jYXJkJykuZGF0YXNldC5pZFxuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRpZCA9IG51bGxcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmYS1yZWd1bGFyJykpIHtcblx0XHRcdGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2ZhLXJlZ3VsYXInKTtcblx0XHRcdGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2ZhLXNvbGlkJyk7XG5cdFx0XHRlLnRhcmdldC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHRcdHRoaXMuZmF2b3JpdGVzLnB1c2goaWQpO1xuXHRcdH0gZWxzZSBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmYS1zb2xpZCcpKSB7XG5cdFx0XHRlLnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdmYS1zb2xpZCcpO1xuXHRcdFx0ZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnZmEtcmVndWxhcicpO1xuXHRcdFx0ZS50YXJnZXQuc3R5bGUuZGlzcGxheSA9ICcnO1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZhdm9yaXRlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZiAodGhpcy5mYXZvcml0ZXNbaV0gPT09IGlkKSB7XG5cdFx0XHRcdFx0dGhpcy5mYXZvcml0ZXMuc3BsaWNlKGksIDEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmYXZvcml0ZXMnLCBKU09OLnN0cmluZ2lmeSh0aGlzLmZhdm9yaXRlcykpO1xuXHR9O1xuXG5cdHJlbmRlckZhdm9yaXRlcyA9IChpZCkgPT4ge1xuXHRcdHRoaXMuZWxlbWVudHMubW92aWVfYm94LmlubmVySFRNTCA9ICcnO1xuXHRcdGlkID0gdGhpcy5mYXZvcml0ZXM7XG5cblx0XHRpZC5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHRnZXRNb3ZpZUluZm8oaXRlbSkudGhlbigoaW5mbykgPT4ge1xuXHRcdFx0XHR0aGlzLmNyZWF0ZU1vdmllQ2FyZChpbmZvKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9O1xuXG5cdGNyZWF0ZU1vdmllQ2FyZCA9IChpdGVtKSA9PiB7XG5cdFx0bGV0IHRpdGxlID0gaXRlbS5UaXRsZTtcblx0XHRsZXQgcG9zdGVyID0gaXRlbS5Qb3N0ZXI7XG5cdFx0bGV0IGljb25DbGFzcyA9ICdmYS1yZWd1bGFyIGZhLWhlYXJ0JztcblxuXHRcdGlmICh0aGlzLmZhdm9yaXRlcy5pbmNsdWRlcyhpdGVtLmltZGJJRCkpIGljb25DbGFzcyA9ICdmYS1zb2xpZCBmYS1oZWFydCc7XG5cdFx0aWYgKHRpdGxlLmxlbmd0aCA+IDYwKSB0aXRsZSA9IGl0ZW0uVGl0bGUuc3Vic3RyaW5nKDAsIDYwKSArICcuLi4nO1xuXHRcdGlmIChwb3N0ZXIgPT0gJ04vQScpIHBvc3RlciA9ICdodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vMjEweDI5NSc7XG5cblx0XHRjb25zdCBkaXZDYXJkID0gdGhpcy5jcmVhdGVET01FbGVtKCdkaXYnLCAnbW92aWUtY2FyZCcpO1xuXHRcdGNvbnN0IGhlYWRpbmcgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2gzJywgbnVsbCwgdGl0bGUpO1xuXHRcdGNvbnN0IHBhcmFncmFwaCA9IHRoaXMuY3JlYXRlRE9NRWxlbSgncCcsIG51bGwsIGl0ZW0uWWVhcik7XG5cdFx0Y29uc3QgaWNvbiA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnaScsIGljb25DbGFzcyk7XG5cdFx0Y29uc3Qgc2hhZG93ID0gdGhpcy5jcmVhdGVET01FbGVtKCdkaXYnLCAnc2hhZG93Jyk7XG5cblx0XHRpZiAoaWNvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2ZhLXNvbGlkJykpIGljb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cblx0XHRzaGFkb3cuYXBwZW5kKGhlYWRpbmcsIHBhcmFncmFwaCk7XG5cdFx0ZGl2Q2FyZC5hcHBlbmQoaWNvbiwgc2hhZG93KTtcblx0XHRkaXZDYXJkLmRhdGFzZXQuaWQgPSBpdGVtLmltZGJJRDtcblx0XHRkaXZDYXJkLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHtwb3N0ZXJ9KWA7XG5cblx0XHR0aGlzLmVsZW1lbnRzLnRpdGxlX2JveC5pbm5lckhUTUwgPSAnJztcblx0XHR0aGlzLmVsZW1lbnRzLm1vdmllX2JveC5hcHBlbmQoZGl2Q2FyZCk7XG5cblx0XHRkaXZDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuTW92aWVTZWNvbmRWaWV3KTtcblx0fTtcblxuXHRjcmVhdGVET01FbGVtID0gKHRhZ05hbWUsIGNsYXNzTmFtZSwgdGV4dENvbnRlbnQsIHNyYykgPT4ge1xuXHRcdGNvbnN0IHRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSk7XG5cdFx0dGFnLmNsYXNzTGlzdCA9IGNsYXNzTmFtZTtcblxuXHRcdGlmICh0ZXh0Q29udGVudCkge1xuXHRcdFx0dGFnLnRleHRDb250ZW50ID0gdGV4dENvbnRlbnQ7XG5cdFx0fVxuXHRcdGlmIChzcmMpIHtcblx0XHRcdHRhZy5zcmMgPSBzcmM7XG5cdFx0fVxuXHRcdHJldHVybiB0YWc7XG5cdH07XG5cblx0b3Blbk1vdmllU2Vjb25kVmlldyA9IChldmVudCkgPT4ge1xuXHRcdGxldCBtb3ZpZUlkO1xuXG5cdFx0aWYgKGV2ZW50LnRhcmdldC5kYXRhc2V0LmlkKSB7XG5cdFx0XHRtb3ZpZUlkID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQuaWQ7XG5cdFx0fSBlbHNlIGlmIChcblx0XHRcdCFldmVudC50YXJnZXQuZGF0YXNldC5pZCAmJlxuXHRcdFx0IWV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2ZhLWhlYXJ0Jylcblx0XHQpIHtcblx0XHRcdG1vdmllSWQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLm1vdmllLWNhcmQnKS5kYXRhc2V0LmlkO1xuXHRcdH1cblxuXHRcdGdldE1vdmllSW5mbyhtb3ZpZUlkKS50aGVuKChpbmZvKSA9PiB7XG5cdFx0XHRsZXQgaW1kYlJhdGluZztcblx0XHRcdGxldCBydFJhdGluZztcblx0XHRcdGxldCBtZXRhUmF0aW5nO1xuXHRcdFx0bGV0IHBvc3RlckltYWdlID0gaW5mby5Qb3N0ZXI7XG5cdFx0XHRsZXQgaWNvbkNsYXNzID0gJ2ZhLXJlZ3VsYXIgZmEtaGVhcnQnO1xuXG5cdFx0XHRpZiAodGhpcy5mYXZvcml0ZXMuaW5jbHVkZXMoaW5mby5pbWRiSUQpKSBpY29uQ2xhc3MgPSAnZmEtc29saWQgZmEtaGVhcnQnO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRpbWRiUmF0aW5nID0gaW5mby5SYXRpbmdzWzBdLlZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRpbWRiUmF0aW5nID0gJ25vIHJhdGluZyc7XG5cdFx0XHR9XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRydFJhdGluZyA9IGluZm8uUmF0aW5nc1sxXS5WYWx1ZTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0cnRSYXRpbmcgPSAnbm8gcmF0aW5nJztcblx0XHRcdH1cblx0XHRcdHRyeSB7XG5cdFx0XHRcdG1ldGFSYXRpbmcgPSBpbmZvLlJhdGluZ3NbMl0uVmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdG1ldGFSYXRpbmcgPSAnbm8gcmF0aW5nJztcblx0XHRcdH1cblxuXHRcdFx0aWYgKHBvc3RlckltYWdlID09ICdOL0EnKVxuXHRcdFx0XHRwb3N0ZXJJbWFnZSA9ICdodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vMzUweDU1MCc7XG5cblx0XHRcdGNvbnN0IGRldGFpbHNEaXYgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2RpdicsICdtb3ZpZS1kZXRhaWxzLWJveCcpO1xuXHRcdFx0Y29uc3QgaW1nID0gdGhpcy5jcmVhdGVET01FbGVtKCdpbWcnLCAncG9zdGVyJywgbnVsbCwgcG9zdGVySW1hZ2UpO1xuXHRcdFx0Y29uc3QgZGV0YWlsc1RleHQgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2RpdicsICdkZXRhaWxzJyk7XG5cdFx0XHRjb25zdCB0aXRsZSA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnaDInLCBudWxsLCBpbmZvLlRpdGxlKTtcblx0XHRcdGNvbnN0IHllYXIgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ3AnLCBudWxsLCBgWWVhcjogJHtpbmZvLlllYXJ9YCk7XG5cdFx0XHRjb25zdCBhY3RvcnMgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ3AnLCBudWxsLCBgQWN0b3JzOiAke2luZm8uQWN0b3JzfWApO1xuXHRcdFx0Y29uc3QgZ2VucmVzID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgbnVsbCwgYEdlbnJlczogJHtpbmZvLkdlbnJlfWApO1xuXHRcdFx0Y29uc3QgZGlyZWN0b3IgPSB0aGlzLmNyZWF0ZURPTUVsZW0oXG5cdFx0XHRcdCdwJyxcblx0XHRcdFx0bnVsbCxcblx0XHRcdFx0YERpcmVjdG9yOiAke2luZm8uRGlyZWN0b3J9YFxuXHRcdFx0KTtcblx0XHRcdGNvbnN0IHJ1bnRpbWUgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ3AnLCBudWxsLCBgUnVudGltZTogJHtpbmZvLlJ1bnRpbWV9YCk7XG5cdFx0XHRjb25zdCBjb3VudHJ5ID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgbnVsbCwgYENvdW50cnk6ICR7aW5mby5Db3VudHJ5fWApO1xuXHRcdFx0Y29uc3QgaW5mb1RleHQgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ3AnLCAnaW5mby10ZXh0JywgYCR7aW5mby5QbG90fWApO1xuXHRcdFx0Y29uc3QgcmF0aW5nRGV0YWlsc0RpdiA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnZGl2JywgJ3JhdGluZy1kZXRhaWxzJyk7XG5cdFx0XHRjb25zdCBjbG9zZUJ0biA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnYnV0dG9uJywgJ2RldGFpbHMtYnRuJywgJ2Nsb3NlJyk7XG5cdFx0XHRjb25zdCBpY29uID0gdGhpcy5jcmVhdGVET01FbGVtKCdpJywgaWNvbkNsYXNzKTtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmF0aW5nQm94RGl2T25lID0gdGhpcy5jcmVhdGVET01FbGVtKCdkaXYnLCAncmF0aW5nLWJveCcpO1xuXHRcdFx0Y29uc3QgcmF0aW5nSW1nT25lID0gdGhpcy5jcmVhdGVET01FbGVtKCdpbWcnLCBudWxsLCBudWxsLCAnL2Rpc3QvaW1nL2ltZGIyLnBuZycpO1xuXHRcdFx0Y29uc3QgcmF0aW5nUGFyYWdyYXBoT25lID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgJ3JhdGluZycsIGltZGJSYXRpbmcpO1xuXG5cdFx0XHRjb25zdCByYXRpbmdCb3hEaXZUd28gPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2RpdicsICdyYXRpbmctYm94Jyk7XG5cdFx0XHRjb25zdCByYXRpbmdJbWdUd28gPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2ltZycsIG51bGwsIG51bGwsICcvZGlzdC9pbWcvUlRsb2dvLnBuZycpO1xuXHRcdFx0Y29uc3QgcmF0aW5nUGFyYWdyYXBoVHdvID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgJ3JhdGluZycsIHJ0UmF0aW5nKTtcblxuXHRcdFx0Y29uc3QgcmF0aW5nQm94RGl2VGhyZWUgPSB0aGlzLmNyZWF0ZURPTUVsZW0oJ2RpdicsICdyYXRpbmctYm94Jyk7XG5cdFx0XHRjb25zdCByYXRpbmdJbWdUaHJlZSA9IHRoaXMuY3JlYXRlRE9NRWxlbSgnaW1nJywgbnVsbCwgbnVsbCwgJy9kaXN0L2ltZy9tZXRhY3JpdGljTG9nby5wbmcnKTtcblx0XHRcdGNvbnN0IHJhdGluZ1BhcmFncmFwaFRocmVlID0gdGhpcy5jcmVhdGVET01FbGVtKCdwJywgJ3JhdGluZycsIG1ldGFSYXRpbmcpO1xuXHRcdFx0XG5cblx0XHRcdHJhdGluZ0JveERpdk9uZS5hcHBlbmQocmF0aW5nSW1nT25lLCByYXRpbmdQYXJhZ3JhcGhPbmUpO1xuXHRcdFx0cmF0aW5nQm94RGl2VHdvLmFwcGVuZChyYXRpbmdJbWdUd28sIHJhdGluZ1BhcmFncmFwaFR3byk7XG5cdFx0XHRyYXRpbmdCb3hEaXZUaHJlZS5hcHBlbmQocmF0aW5nSW1nVGhyZWUsIHJhdGluZ1BhcmFncmFwaFRocmVlKTtcblxuXHRcdFx0cmF0aW5nRGV0YWlsc0Rpdi5hcHBlbmQoXG5cdFx0XHRcdHJhdGluZ0JveERpdk9uZSxcblx0XHRcdFx0cmF0aW5nQm94RGl2VHdvLFxuXHRcdFx0XHRyYXRpbmdCb3hEaXZUaHJlZVxuXHRcdFx0KTtcblxuXHRcdFx0ZGV0YWlsc1RleHQuYXBwZW5kKFxuXHRcdFx0XHR0aXRsZSxcblx0XHRcdFx0eWVhcixcblx0XHRcdFx0YWN0b3JzLFxuXHRcdFx0XHRnZW5yZXMsXG5cdFx0XHRcdGRpcmVjdG9yLFxuXHRcdFx0XHRydW50aW1lLFxuXHRcdFx0XHRjb3VudHJ5LFxuXHRcdFx0XHRpbmZvVGV4dCxcblx0XHRcdFx0cmF0aW5nRGV0YWlsc0Rpdixcblx0XHRcdFx0Y2xvc2VCdG4sXG5cdFx0XHRcdGljb25cblx0XHRcdCk7XG5cdFx0XHRkZXRhaWxzRGl2LmFwcGVuZChpbWcsIGRldGFpbHNUZXh0KTtcblxuXHRcdFx0ZGV0YWlsc0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuXHRcdFx0aWNvbi5kYXRhc2V0LmlkID0gaW5mby5pbWRiSURcblx0XHRcdHRoaXMuZWxlbWVudHMubW92aWVfYm94LmFwcGVuZChkZXRhaWxzRGl2KTtcblx0XHRcdHRoaXMuZWxlbWVudHMub3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHRcdGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcblxuXHRcdFx0Y29uc3Qgdmlld0Nsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRldGFpbHMtYnRuJyk7XG5cdFx0XHR2aWV3Q2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZWxlbWVudHMubW92aWVfYm94LnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudHMubW92aWVfYm94Lmxhc3RDaGlsZCk7XG5cdFx0XHRcdHRoaXMuZWxlbWVudHMub3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJyc7XG5cdFx0XHR9KTtcblx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYS1oZWFydCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5hZGRUb0Zhdm9yaXRlcylcblx0XHR9KVxuXHR9O1xufVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgbmV3IE1vdmllQXBwKCkpO1xuIl19
